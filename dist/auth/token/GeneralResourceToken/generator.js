var _0x26628e=_0x1e40;function _0x3052(){var _0xb3db3b=['putLong','attributes','putText','427499trmDrP','validatePolicy','time','putString','19185eCaPce','TOKEN_PREFIX','toTencentBase64','action的数量最多不能超过3个','has','332TVEDMt','请正确设置当前时间，或者干脆不要设置。注意时间的单位是秒而不是毫秒。','stringify','checkExpire','sig','appid','getTokenType','action的name不能为空','putByteArray','generateToken','toString','floor','notBlank','secretKeySpec','569226zARUkR','763852myYXGu','action的name重复','action（','checkInit','code','getSignatureFields','2625876YnJrra','now','getParamsCodec','tokenType','convertTokenString','112320jLNHuv','VcGeneralResource','133wzGiOU','145458kDmeRq','base64','toShortJsonStr','generateSig','）的attributes为空','name','expire','policy为空','length','policy'];_0x3052=function(){return _0xb3db3b;};return _0x3052();}(function(_0x4cb316,_0x3e7ae5){var _0x104399=_0x1e40,_0xb4a243=_0x4cb316();while(!![]){try{var _0x205198=parseInt(_0x104399(0x1d8))/0x1+-parseInt(_0x104399(0x1f0))/0x2+-parseInt(_0x104399(0x1ef))/0x3+parseInt(_0x104399(0x1e1))/0x4*(-parseInt(_0x104399(0x1dc))/0x5)+-parseInt(_0x104399(0x1fe))/0x6*(-parseInt(_0x104399(0x1fd))/0x7)+parseInt(_0x104399(0x1fb))/0x8+parseInt(_0x104399(0x1f6))/0x9;if(_0x205198===_0x3e7ae5)break;else _0xb4a243['push'](_0xb4a243['shift']());}catch(_0xa47cbb){_0xb4a243['push'](_0xb4a243['shift']());}}}(_0x3052,0x4a2a5));let TokenGenerator=require('../TokenGenerator'),BufferedEncoder=require('../BufferedEncoder'),TokenType=require('../TokenType'),TOKEN_MAX_LENGTH=0x200,SIGN_FIELDS=[_0x26628e(0x1e6),'policy',_0x26628e(0x1da),_0x26628e(0x1d1)];function _0x1e40(_0x464a12,_0x46db30){var _0x305260=_0x3052();return _0x1e40=function(_0x1e40e5,_0xa8f246){_0x1e40e5=_0x1e40e5-0x1d1;var _0x180bdc=_0x305260[_0x1e40e5];return _0x180bdc;},_0x1e40(_0x464a12,_0x46db30);}class GeneralResourceTokenGenerator extends TokenGenerator{constructor(){super();}[_0x26628e(0x1f5)](){return SIGN_FIELDS;}[_0x26628e(0x1f8)](){var _0x21a964=_0x26628e;let _0x1f93b9=this;return{'tokenType':TokenType[_0x21a964(0x1fc)],'encode':function(_0x1e84c9){var _0x357d49=_0x21a964,_0x1f63a0=new BufferedEncoder(0x400),_0x1e84c9=(_0x1f63a0['putByte'](this[_0x357d49(0x1e7)]()[_0x357d49(0x1f4)]),_0x1f63a0[_0x357d49(0x1db)](_0x1e84c9[_0x357d49(0x1e6)]),_0x1f63a0[_0x357d49(0x1d7)](_0x1e84c9['policy']),_0x1f63a0[_0x357d49(0x1d5)](_0x1e84c9[_0x357d49(0x1da)]),_0x1f63a0['putUnsignedInt'](_0x1e84c9[_0x357d49(0x1d1)]),_0x1f63a0['putString'](_0x1e84c9['sig']),_0x1f63a0[_0x357d49(0x1e9)](_0x1e84c9['#']),_0x1f63a0['toByteArray']());return _0x1f93b9[_0x357d49(0x1de)](_0x1e84c9[_0x357d49(0x1eb)](_0x357d49(0x1ff)));},'getTokenType':function(){var _0x3579cc=_0x21a964;return this[_0x3579cc(0x1f9)];}};}[_0x26628e(0x1d9)](_0x488a9b){var _0x3786bb=_0x26628e;if(0x0===_0x488a9b['length'])throw new Error(_0x3786bb(0x1d2));if(0x3<_0x488a9b[_0x3786bb(0x1d3)])throw new Error(_0x3786bb(0x1df));var _0x2ef343,_0x172f52=new Set();for(_0x2ef343 of _0x488a9b){if(!_0x2ef343[_0x3786bb(0x203)])throw new Error(_0x3786bb(0x1e8));if(_0x172f52[_0x3786bb(0x1e0)](_0x2ef343[_0x3786bb(0x203)]))throw new Error(_0x3786bb(0x1f1));if(_0x172f52['add'](_0x2ef343['name']),!_0x2ef343[_0x3786bb(0x1d6)]||0x0===_0x2ef343['attributes'][_0x3786bb(0x1d3)])throw new Error(_0x3786bb(0x1f2)+_0x2ef343['name']+_0x3786bb(0x202));this['checkAttributes'](_0x2ef343[_0x3786bb(0x1d6)]);}}[_0x26628e(0x200)](_0x5c4e02){var _0x550856=_0x26628e,_0x7536e4,_0x234517={};for(_0x7536e4 of _0x5c4e02){var _0x47a899,_0x12e04e,_0x317c9e={};for([_0x47a899,_0x12e04e]of _0x7536e4[_0x550856(0x1d6)])_0x317c9e[_0x47a899]=_0x12e04e;_0x234517[_0x7536e4[_0x550856(0x203)]]=_0x317c9e;}return JSON[_0x550856(0x1e3)](_0x234517);}[_0x26628e(0x1ea)](_0x41bfd6){var _0x15e43b=_0x26628e,_0x479799=Math[_0x15e43b(0x1ec)](Date[_0x15e43b(0x1f7)]()/0x3e8);if(_0x41bfd6[_0x15e43b(0x1da)]){if(0x12c<Math['abs'](_0x41bfd6[_0x15e43b(0x1da)]-_0x479799))throw new Error(_0x15e43b(0x1e2));}else _0x41bfd6[_0x15e43b(0x1da)]=_0x479799;this['validatePolicy'](_0x41bfd6['policy']),(_0x479799={'appid':this[_0x15e43b(0x1ed)](_0x41bfd6[_0x15e43b(0x1e6)],0x40,_0x15e43b(0x1e6)),'policy':this[_0x15e43b(0x200)](_0x41bfd6[_0x15e43b(0x1d4)]),'time':_0x41bfd6[_0x15e43b(0x1da)],'expire':this[_0x15e43b(0x1e4)](_0x41bfd6['expire'])},_0x41bfd6=this['toSignString'](_0x479799),this[_0x15e43b(0x1f3)](),_0x479799[_0x15e43b(0x1e5)]=this[_0x15e43b(0x201)](_0x41bfd6,this[_0x15e43b(0x1ee)]),_0x41bfd6=TokenGenerator[_0x15e43b(0x1dd)]+this[_0x15e43b(0x1fa)](_0x479799,!0x0));if(_0x41bfd6[_0x15e43b(0x1d3)]>TOKEN_MAX_LENGTH)throw new Error('token长度不可超过'+TOKEN_MAX_LENGTH);return _0x41bfd6;}}module['exports']=GeneralResourceTokenGenerator;